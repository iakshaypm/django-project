<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.10.0" xml:lang="en-US">
  <compounddef id="consumers_8py" kind="file" language="Python">
    <compoundname>consumers.py</compoundname>
    <innerclass refid="classchat_1_1consumers_1_1ChatConsumer" prot="public">chat::consumers::ChatConsumer</innerclass>
    <innernamespace refid="namespacechat">chat</innernamespace>
    <innernamespace refid="namespacechat_1_1consumers">chat::consumers</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacechat_1_1consumers" refkind="compound"><highlight class="keyword">import</highlight><highlight class="normal"><sp/>json</highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>asgiref.sync<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>async_to_sync</highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>channels.generic.websocket<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>WebsocketConsumer</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.models<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Room,<sp/>Message</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight></codeline>
<codeline lineno="10" refid="classchat_1_1consumers_1_1ChatConsumer" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classchat_1_1consumers_1_1ChatConsumer" kindref="compound">ChatConsumer</ref>(WebsocketConsumer):</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="12" refid="classchat_1_1consumers_1_1ChatConsumer_1aab4937a9dd0274ba28136c4360866f52" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchat_1_1consumers_1_1ChatConsumer_1aab4937a9dd0274ba28136c4360866f52" kindref="member">__init__</ref>(self,<sp/>*args,<sp/>**kwargs):</highlight></codeline>
<codeline lineno="13"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super().<ref refid="classchat_1_1consumers_1_1ChatConsumer_1aab4937a9dd0274ba28136c4360866f52" kindref="member">__init__</ref>(args,<sp/>kwargs)</highlight></codeline>
<codeline lineno="14" refid="classchat_1_1consumers_1_1ChatConsumer_1aa5af8c0e764dd1bec381a82893b5e87a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1aa5af8c0e764dd1bec381a82893b5e87a" kindref="member">room_name</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15" refid="classchat_1_1consumers_1_1ChatConsumer_1aa410e76ab8abadba6fec042b8d7e45fb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1aa410e76ab8abadba6fec042b8d7e45fb" kindref="member">room_group_name</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16" refid="classchat_1_1consumers_1_1ChatConsumer_1a2abf97fcb49eb060f4d8705efc04e84a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a2abf97fcb49eb060f4d8705efc04e84a" kindref="member">room</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17" refid="classchat_1_1consumers_1_1ChatConsumer_1a1ecef2999ff803fe49ca7b64371bb390" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a1ecef2999ff803fe49ca7b64371bb390" kindref="member">user</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19" refid="classchat_1_1consumers_1_1ChatConsumer_1a95f62c60359a5d0e10c24a5c1eabaeed" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchat_1_1consumers_1_1ChatConsumer_1a95f62c60359a5d0e10c24a5c1eabaeed" kindref="member">connect</ref>(self):</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1aa5af8c0e764dd1bec381a82893b5e87a" kindref="member">room_name</ref><sp/>=<sp/>self.scope[</highlight><highlight class="stringliteral">&apos;url_route&apos;</highlight><highlight class="normal">][</highlight><highlight class="stringliteral">&apos;kwargs&apos;</highlight><highlight class="normal">][</highlight><highlight class="stringliteral">&apos;room_name&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1aa410e76ab8abadba6fec042b8d7e45fb" kindref="member">room_group_name</ref><sp/>=<sp/>f</highlight><highlight class="stringliteral">&apos;chat_{self.room_name}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a2abf97fcb49eb060f4d8705efc04e84a" kindref="member">room</ref><sp/>=<sp/>Room.objects.get(name=self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1aa5af8c0e764dd1bec381a82893b5e87a" kindref="member">room_name</ref>)</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a1ecef2999ff803fe49ca7b64371bb390" kindref="member">user</ref><sp/>=<sp/>self.scope[</highlight><highlight class="stringliteral">&apos;user&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a2abf97fcb49eb060f4d8705efc04e84a" kindref="member">room</ref>.type<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type_list<sp/>=<sp/>[1,<sp/>2,<sp/>3,<sp/>4]</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a1ecef2999ff803fe49ca7b64371bb390" kindref="member">user</ref>.user_type<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>type_list:</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.accept()</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a2abf97fcb49eb060f4d8705efc04e84a" kindref="member">room</ref>.type<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type_list<sp/>=<sp/>[2,<sp/>3,<sp/>4]</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a1ecef2999ff803fe49ca7b64371bb390" kindref="member">user</ref>.user_type<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>type_list:</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.accept()</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a2abf97fcb49eb060f4d8705efc04e84a" kindref="member">room</ref>.type<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type_list<sp/>=<sp/>[3,<sp/>4]</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a1ecef2999ff803fe49ca7b64371bb390" kindref="member">user</ref>.user_type<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>type_list:</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.accept()</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>connection<sp/>has<sp/>to<sp/>be<sp/>accepted</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>self.user.user_type<sp/>==<sp/>self.room.type:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>self.accept()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>print(self.user.user_type,<sp/>self.room.type)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>join<sp/>the<sp/>room<sp/>group</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>async_to_sync(self.channel_layer.group_add)(</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1aa410e76ab8abadba6fec042b8d7e45fb" kindref="member">room_group_name</ref>,</highlight></codeline>
<codeline lineno="45" refid="classchat_1_1consumers_1_1ChatConsumer_1a3c65dc0f4016067de7b1cb9f5bf1016d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a3c65dc0f4016067de7b1cb9f5bf1016d" kindref="member">channel_name</ref>,</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48" refid="classchat_1_1consumers_1_1ChatConsumer_1aa13985fa6f7720834750970610ab0784" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchat_1_1consumers_1_1ChatConsumer_1aa13985fa6f7720834750970610ab0784" kindref="member">disconnect</ref>(self,<sp/>close_code):</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>async_to_sync(self.channel_layer.group_discard)(</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1aa410e76ab8abadba6fec042b8d7e45fb" kindref="member">room_group_name</ref>,</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a3c65dc0f4016067de7b1cb9f5bf1016d" kindref="member">channel_name</ref>,</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54" refid="classchat_1_1consumers_1_1ChatConsumer_1a468b525e29b77990588e3ab83b69e67d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchat_1_1consumers_1_1ChatConsumer_1a468b525e29b77990588e3ab83b69e67d" kindref="member">receive</ref>(self,<sp/>text_data=None,<sp/>bytes_data=None):</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>text_data_json<sp/>=<sp/>json.loads(text_data)</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message<sp/>=<sp/>text_data_json[</highlight><highlight class="stringliteral">&apos;message&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a1ecef2999ff803fe49ca7b64371bb390" kindref="member">user</ref>.is_authenticated:</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>send<sp/>chat<sp/>message<sp/>event<sp/>to<sp/>the<sp/>room</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>async_to_sync(self.channel_layer.group_send)(</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1aa410e76ab8abadba6fec042b8d7e45fb" kindref="member">room_group_name</ref>,</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;chat_message&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;user&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a1ecef2999ff803fe49ca7b64371bb390" kindref="member">user</ref>.name,</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;message&apos;</highlight><highlight class="normal">:<sp/>message,</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Message.objects.create(user=self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a1ecef2999ff803fe49ca7b64371bb390" kindref="member">user</ref>,<sp/>room=self.<ref refid="classchat_1_1consumers_1_1ChatConsumer_1a2abf97fcb49eb060f4d8705efc04e84a" kindref="member">room</ref>,<sp/>content=message)</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73" refid="classchat_1_1consumers_1_1ChatConsumer_1ab262d45be15d53f8bec11a52690e9217" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classchat_1_1consumers_1_1ChatConsumer_1ab262d45be15d53f8bec11a52690e9217" kindref="member">chat_message</ref>(self,<sp/>event):</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.send(text_data=json.dumps(event))</highlight></codeline>
    </programlisting>
    <location file="/tmp/github_repos_arch_doc_gen/iakshaypm/django-project/chat/consumers.py"/>
  </compounddef>
</doxygen>
